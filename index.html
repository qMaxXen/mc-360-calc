<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Minecraft DPI / cm360 Calculator</title>
  <style>
    :root{--bg:#0f172a;--card:#0b1220;--accent:#60a5fa;--muted:#94a3b8;--glass:rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,#020617 0%, #07102a 100%);color:#e6eef8;display:flex;align-items:center;justify-content:center;padding:28px}
    .card{background:var(--card);border-radius:12px;padding:20px;width:820px;max-width:96%;box-shadow:0 6px 30px rgba(2,6,23,0.6)}
    h1{margin:0 0 10px;font-size:20px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input,select{width:100%;padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit;font-size:14px}
    .results{margin-top:14px;display:flex;gap:12px;flex-wrap:wrap}
    .result{flex:1 1 200px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:10px}
    .small{font-size:12px;color:var(--muted)}
    button{background:var(--accent);border:none;color:#04233a;padding:8px 10px;border-radius:8px;cursor:pointer}
    .table{margin-top:12px;border-radius:8px;padding:8px;background:rgba(255,255,255,0.02)}
    .row{display:flex;gap:8px;align-items:center;margin-bottom:6px}
    .row input{flex:1}
    .footer{margin-top:14px;font-size:13px;color:var(--muted)}
    .muted{color:var(--muted)}
    @media (max-width:640px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <main class="card" role="main">
    <h1>Minecraft DPI / cm360 Calculator</h1>
    <p class="small">Enter your <strong>Minecraft sens</strong> (from <code>options.txt</code>), <strong>DPI</strong>, and <strong>Windows Sens</strong>. The page calculates <em>in/360</em> and <em>cm/360</em> using the formulas you provided.</p>

    <div class="grid" style="margin-top:12px">
      <div>
        <label for="mcSens">Minecraft sens (from options.txt)</label>
        <input id="mcSens" inputmode="decimal" placeholder="e.g. 0.5" />
      </div>

      <div>
        <label for="dpi">DPI</label>
        <input id="dpi" inputmode="numeric" placeholder="e.g. 800" />
      </div>

      <div>
        <label for="winSens">Windows Sens (slider value or custom)</label>
        <select id="winSens"></select>
      </div>

      <div>
        <label>&nbsp;</label>
        <div style="display:flex;gap:8px">
          <button id="copyBtn">Copy results</button>
          <button id="resetBtn" style="background:#ef4444;color:white">Reset</button>
        </div>
      </div>
    </div>

    <div class="results" id="results">
      <div class="result">
        <div class="small">in / 360</div>
        <div id="in360" style="font-size:20px;font-weight:600">—</div>
      </div>
      <div class="result">
        <div class="small">cm / 360</div>
        <div id="cm360" style="font-size:20px;font-weight:600">—</div>
      </div>
      <div class="result">
        <div class="small">degrees / count</div>
        <div id="degpc" style="font-size:18px;font-weight:600">—</div>
      </div>
      <div class="result">
        <div class="small">Minecraft percent</div>
        <div id="mcPercent" style="font-size:18px;font-weight:600">—</div>
      </div>
      <div class="result">
        <div class="small">Cursor sensitivity (lookup × DPI)</div>
        <div id="cursorSens" style="font-size:16px;font-weight:600">—</div>
      </div>
    </div>

    <details style="margin-top:12px" open>
      <summary class="small">Cursor sensitivity lookup table (editable)</summary>
      <p class="small muted">This table emulates the <code>VLOOKUP</code> you mentioned. Edit the multiplier values to match your reference table. The calculator multiplies the selected multiplier by DPI to produce the cursor sensitivity value.</p>
      <div class="table" id="lookupTable"></div>
    </details>

    <div class="footer">
      <strong>Notes:</strong> The formulas implemented are:
      <ul class="small muted">
        <li><code>degreesPerCount = ((mcSens * 0.6 + 0.2)^3) * 1.2</code></li>
        <li><code>in/360 = TRUNC(360 / (degreesPerCount * DPI), 2)</code></li>
        <li><code>cm/360 = in/360 * 2.54</code></li>
        <li><code>mc percent = TRUNC((mcSens * 2) * 100, 0) + "%"</code></li>
        <li><code>cursor sens = (lookup multiplier for Windows Sens) * DPI</code></li>
      </ul>
    </div>
  </main>

<script>
function safeNum(v){ if (v===null || v===undefined) return NaN; const s = String(v).trim(); if (s==='') return NaN; return Number(s); }
function truncTo(n, d){ if (!isFinite(n)) return NaN; const p = Math.pow(10, d); return Math.trunc(n * p) / p; }
function formatTrunc(n, d){ if (!isFinite(n)) return '—'; const t = truncTo(n, d); // ensure fixed decimals for display
  return t.toFixed(d); }

const defaultLookup = [
  0.10, 0.12, 0.14, 0.16, 0.18, 0.20, 0.22, 0.24, 0.26, 0.28, 0.30
];

const mcSensInput = document.getElementById('mcSens');
const dpiInput = document.getElementById('dpi');
const winSelect = document.getElementById('winSens');
const in360El = document.getElementById('in360');
const cm360El = document.getElementById('cm360');
const degpcEl = document.getElementById('degpc');
const mcPercEl = document.getElementById('mcPercent');
const cursorEl = document.getElementById('cursorSens');
const lookupTableEl = document.getElementById('lookupTable');
const copyBtn = document.getElementById('copyBtn');
const resetBtn = document.getElementById('resetBtn');

function populateWinSelect(){
  winSelect.innerHTML = '';
  for(let i=1;i<=11;i++){
    const opt = document.createElement('option'); opt.value = String(i); opt.textContent = String(i);
    winSelect.appendChild(opt);
  }
  const custom = document.createElement('option'); custom.value = 'custom'; custom.textContent = 'Custom multiplier...';
  winSelect.appendChild(custom);
}

let lookup = defaultLookup.slice();
function renderLookupTable(){
  lookupTableEl.innerHTML = '';
  for(let i=1;i<=11;i++){
    const row = document.createElement('div'); row.className='row';
    const label = document.createElement('div'); label.textContent = 'Windows Sens ' + i; label.style.width='120px'; label.style.fontSize='13px'; label.style.opacity=0.9;
    const inp = document.createElement('input'); inp.type='number'; inp.step='0.01'; inp.value = lookup[i] !== undefined && !isNaN(lookup[i]) ? String(lookup[i]) : '';
    inp.dataset.idx = String(i);
    inp.addEventListener('input', (e)=>{ const idx = Number(e.target.dataset.idx); const v = safeNum(e.target.value); lookup[idx]=isNaN(v)?NaN:v; compute(); });
    const note = document.createElement('div'); note.textContent = '× DPI'; note.style.width='50px'; note.style.fontSize='13px'; note.style.opacity=0.6;
    row.appendChild(label); row.appendChild(inp); row.appendChild(note);
    lookupTableEl.appendChild(row);
  }
}

function compute(){
  const mc = safeNum(mcSensInput.value);
  const dpi = safeNum(dpiInput.value);
  const win = winSelect.value;

  if (!isFinite(mc) || !isFinite(dpi)){
    in360El.textContent = '—'; cm360El.textContent = '—'; degpcEl.textContent = '—'; mcPercEl.textContent = '—'; cursorEl.textContent = '—';
    return;
  }

  const degreesPerCount = Math.pow(mc * 0.6 + 0.2, 3) * 1.2;
  const countsPer360 = 360 / (degreesPerCount * dpi);
  const in360 = truncTo(countsPer360, 2);
  const cm360 = truncTo(countsPer360 * 2.54, 2);

  degpcEl.textContent = (isFinite(degreesPerCount) ? (truncTo(degreesPerCount, 6)) : '—');
  in360El.textContent = isFinite(in360) ? in360.toFixed(2) : '—';
  cm360El.textContent = isFinite(cm360) ? cm360.toFixed(2) : '—';
  mcPercEl.textContent = (isFinite(mc) ? (Math.trunc((mc * 2) * 100) + '%') : '—');

  let multiplier = NaN;
  if (win === 'custom'){
    multiplier = NaN; 
  } else {
    const idx = Number(win);
    multiplier = lookup[idx];
  }
  const cursorVal = isFinite(multiplier) && isFinite(dpi) ? truncTo(multiplier * dpi, 2) : NaN;
  cursorEl.textContent = isFinite(cursorVal) ? cursorVal.toFixed(2) : '—';
}

mcSensInput.addEventListener('input', compute);
dpiInput.addEventListener('input', compute);
winSelect.addEventListener('change', compute);
copyBtn.addEventListener('click', ()=>{
  const text = `mcSens=${mcSensInput.value || ''}\nDPI=${dpiInput.value || ''}\nWindowsSens=${winSelect.value}\nin/360=${in360El.textContent}\ncm/360=${cm360El.textContent}\ndegrees/count=${degpcEl.textContent}\nmc%=${mcPercEl.textContent}\ncursorSens=${cursorEl.textContent}`;
  navigator.clipboard && navigator.clipboard.writeText(text).then(()=>{ copyBtn.textContent='Copied'; setTimeout(()=>copyBtn.textContent='Copy results',900); });
});
resetBtn.addEventListener('click', ()=>{ mcSensInput.value=''; dpiInput.value=''; winSelect.value='6'; lookup = defaultLookup.slice(); renderLookupTable(); compute(); });

populateWinSelect(); renderLookupTable(); winSelect.value='6'; mcSensInput.value='0.5'; dpiInput.value='800'; compute();
</script>
</body>
</html>
